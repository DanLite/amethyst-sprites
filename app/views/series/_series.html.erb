<div style="margin: 10px 0">
  
<h3 style="color: #007"><%= html_for_series(series) %></h3>
  
<% if series.state == SERIES_RESERVED  %>
	<% if series.reserver == current_artist %>
		<%= link_to "(Unreserve)", unclaim_pokemon_path(series.pokemon) %>
	<% end %>
	
	<%= render :partial => "series/upload_form", :locals => { :series => series } %>
	
<% else %>

<% events = series.events_for_artist(current_artist) %>
<% unless events.blank? %>
Available actions:
<ul>
	<% events.each do |event| %>
	<li><%= link_to event.to_s.humanize, transition_series_path(series, :event => event), :confirm => (event == :archive ? "Archive these sprites to start from scratch?" : nil) %></li>
	<% end %>
</ul>
<% end %>

<%= render :partial => "series/upload_form", :locals => { :series => series } %>

	<table>
		<tr>
			<th width="160"></th>
			<th>Artist</th>
			<th>Date</th>
		</tr>
		<% series.sprites.order('created_at DESC').each do |sprite| %>
		<tr>
			<td>
				<% if sprite.image? %>
					<%= image_tag sprite.image.url, :title => sprite.step %>
				<% end %>
				<%= render :partial => "sprites/colour_map", :locals => { :colour_map => sprite.colour_map } if sprite.colour_map %>
			</td>
			<td>
				<%= sprite.artist ? sprite.artist.name : series.contributors.map{|c| c.name }.join(", ") %>
			</td>
			<td>
				<%= time_ago_in_words(sprite.image_updated_at) + " ago" if sprite.image? %>
			</td>
		</tr>
		<% end %>
	</table>
<% end %>

</div>